def plot_data(data_folder):
    print("Plotting data...")
    try:
        processed_data = np.loadtxt(os.path.join(data_folder, 'processed_data.txt'), delimiter=',')
        
        if processed_data.size == 0 or processed_data.ndim == 1:
            print("Insufficient data for plotting.")
            return
        
        x, y, z = processed_data[:, 0], processed_data[:, 1], processed_data[:, 2]

        xi = np.linspace(min(x), max(x), 200)
        yi = np.linspace(min(y), max(y), 200)
        X, Y = np.meshgrid(xi, yi)

        Z = griddata((x, y), z, (X, Y), method='linear')

        fig_3d = go.Figure(data=[go.Surface(x=X, y=Y, z=Z, colorscale='Viridis')])
        fig_3d.update_layout(scene=dict(
            xaxis_title='Easting',
            yaxis_title='Northing',
            zaxis_title='Elevation (mm)',
            aspectmode='manual',
            aspectratio=dict(x=1, y=1, z=0.5)
        ), title='3D Surface Plot')
        fig_3d.write_html(os.path.join(data_folder, '3d_surface_plot.html'))

        fig_2d = go.Figure(data=go.Heatmap(x=x, y=y, z=z, colorscale='Viridis'))
        fig_2d.update_layout(
            xaxis_title='Easting',
            yaxis_title='Northing',
            title='2D Elevation Heatmap'
        )
        fig_2d.write_html(os.path.join(data_folder, '2d_heatmap.html'))

        print(f"Plots saved in {data_folder}")
    except Exception as e:
        print(f"An error occurred while plotting: {str(e)}")